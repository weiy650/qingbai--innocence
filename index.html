<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>QingBai: Innocence</title>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Pinyon+Script&family=Playfair+Display:ital,wght@0,400;0,500;0,600;1,400&family=Noto+Serif+SC:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        :root {
            --junzi-green: #4CB785;
            --here-gold: #d4af37;
            --glass-bg: rgba(255, 255, 255, 0.15);
            --glass-border: rgba(255, 255, 255, 0.2);
            --glass-blur: blur(20px);
            --text-main: #ffffff;
            --text-dim: rgba(255,255,255,0.85);
            --fate-paper-bg: #fffcf8;
            --fate-text: #1d1d1f;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            background-color: #a4dcd3; 
            background-image: url('back.jpg'); 
            background-size: cover; 
            background-position: center; 
            background-attachment: fixed;
            font-family: 'Playfair Display', serif; 
            overflow-x: hidden; 
            color: var(--text-main); 
            padding-bottom: 70px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        body::before {
            content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.05); 
            pointer-events: none; z-index: -1;
        }
        #hero-layer { position: relative; width: 100%; min-height: 95vh; display: flex; justify-content: center; align-items: center; padding-top: 40px; padding-bottom: 80px; }
        .poster-container { position: relative; z-index: 10; width: 100%; max-width: 800px; display: flex; flex-direction: column; align-items: center; text-align: center; }
        .fade-up { opacity: 0; transform: translateY(30px); animation: fadeUpAnim 1.2s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes fadeUpAnim { to { opacity: 1; transform: translateY(0); } }
        .main-logo { width: 240px; height: auto; filter: drop-shadow(0 20px 40px rgba(0,0,0,0.1)); z-index: 2; margin-bottom: 20px; animation-delay: 0.1s; }
        .typography-cluster { display: flex; flex-direction: column; align-items: center; position: relative; margin-bottom: 40px; animation-delay: 0.3s; }
        .big-title { font-family: 'Playfair Display', serif; font-size: 4.5rem; font-weight: 600; letter-spacing: 0.15em; line-height: 0.9; text-transform: uppercase; color: rgba(255,255,255,0.95); text-shadow: 0 10px 30px rgba(0,0,0,0.1); position: relative; z-index: 1; margin-left: 8px; }
        .script-title { font-family: 'Pinyon Script', cursive; font-size: 4.8rem; color: #ffffff; margin-top: -40px; text-shadow: 0 10px 30px rgba(0,0,0,0.15); position: relative; z-index: 3; }
        .subtitle-text { font-family: 'Lato', sans-serif; font-size: 0.7rem; font-weight: 600; letter-spacing: 0.3em; text-transform: uppercase; color: var(--text-dim); margin-top: 25px; }
        .info-cluster { animation-delay: 0.5s; display: flex; flex-direction: column; align-items: center; }
        .quote-group { display: flex; flex-direction: column; gap: 12px; margin-bottom: 40px; opacity: 0.95; max-width: 90%; }
        .quote-en { font-family: 'Playfair Display', serif; font-size: 1.15rem; letter-spacing: 0.02em; font-style: italic; }
        .quote-cn { font-family: "Noto Serif SC", serif; font-size: 0.95rem; font-weight: 300; letter-spacing: 0.15em; }
        
        /* Buttons */
        .button-group { 
            display: flex; flex-wrap: wrap; justify-content: center; gap: 16px; 
            margin-top: 10px; 
            position: relative; 
            z-index: 99999 !important; 
            pointer-events: auto !important; 
        }
        .glass-btn { 
            display: inline-flex; align-items: center; justify-content: center; 
            padding: 14px 30px; 
            background: var(--glass-bg); 
            backdrop-filter: var(--glass-blur); -webkit-backdrop-filter: var(--glass-blur);
            border: 1px solid var(--glass-border); 
            border-radius: 100px; 
            color: white; text-decoration: none; 
            font-family: 'Lato', sans-serif; font-size: 0.7rem; font-weight: 600; letter-spacing: 0.2em; text-transform: uppercase; 
            transition: all 0.4s cubic-bezier(0.25, 1, 0.5, 1); 
            cursor: pointer; user-select: none;
            position: relative; z-index: 100000;
        }
        .glass-btn:hover { background: rgba(255, 255, 255, 0.35); transform: scale(1.02); border-color: rgba(255, 255, 255, 0.6); }
        .glass-btn:active { transform: scale(0.98); }
        @media (max-width: 768px) {
            #hero-layer { padding-top: 60px; min-height: auto; }
            .poster-container { padding: 0 20px; }
            .main-logo { width: 180px; } .big-title { font-size: 3.2rem; letter-spacing: 0.1em; } .script-title { font-size: 3rem; margin-top: -25px; }
            .button-group { gap: 10px; width: 100%; max-width: 400px; } .glass-btn { flex: 1 1 auto; padding: 12px 15px; font-size: 0.65rem; white-space: nowrap;}
        }
        #digital-program { 
            display: none; 
            position: relative; z-index: 5; margin-top: 60px; padding-bottom: 80px; 
            width: 100%; max-width: 900px; margin: 0 auto; flex-direction: column; 
        }
        #digital-program.active { display: flex; } 
        .content-img { width: 100%; height: auto; display: block; margin-bottom: -1px; opacity: 0; transform: translateY(30px); transition: all 1s ease-out; }
        .content-img.visible { opacity: 1; transform: translateY(0); }
        .here-section { 
            padding: 80px 40px; margin: 60px 20px; 
            background: linear-gradient(180deg, rgba(255,255,255,0.05) 0%, rgba(20,60,50,0.3) 100%); 
            border: 1px solid rgba(255,255,255,0.15); 
            border-radius: 12px; backdrop-filter: blur(40px); -webkit-backdrop-filter: blur(40px);
            opacity: 0; transform: translateY(30px); transition: all 1s ease-out; 
            text-align: center; 
        }
        .here-section.visible { opacity: 1; transform: translateY(0); }
        .here-pre-title { font-family: 'Lato', sans-serif; font-size: 0.75rem; letter-spacing: 0.3em; text-transform: uppercase; color: rgba(255,255,255,0.7); margin-bottom: 12px; }
        .here-header { font-family: 'Playfair Display', serif; font-size: 2.2rem; margin-bottom: 40px; color: #fff; text-transform: uppercase; letter-spacing: 0.05em; line-height: 1.1; position: relative; display: inline-block; padding-bottom: 20px; }
        .here-header::after { content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 40px; height: 1px; background: var(--here-gold); }
        .here-content { max-width: 700px; margin: 0 auto; text-align: justify; text-align-last: center; }
        .here-content p { font-family: 'Lato', sans-serif; font-size: 0.95rem; line-height: 2; margin-bottom: 25px; color: rgba(255,255,255,0.9); font-weight: 300; }
        .here-links { display: flex; justify-content: center; gap: 40px; margin-top: 50px; padding-top: 30px; border-top: 1px solid rgba(255,255,255,0.1); }
        .here-link-item { display: flex; flex-direction: column; align-items: center; gap: 12px; text-decoration: none; color: rgba(255,255,255,0.8); transition: all 0.3s ease; }
        .here-link-item i { font-size: 1.8rem; color: var(--here-gold); transition: all 0.3s ease; }
        .here-link-item span { font-family: 'Lato'; font-size: 0.65rem; letter-spacing: 0.2em; font-weight: 700; }
        .here-link-item:hover { transform: translateY(-3px); color: white; }
        .here-link-item:hover i { color: white; filter: drop-shadow(0 0 10px rgba(212, 175, 55, 0.8)); }

        /* --- Junzi CTA Section (Updated Texture & Contrast) --- */
        .junzi-cta-section {
            width: 100%;
            margin: 40px 0 60px 0;
            padding: 60px 30px;
            text-align: center;
            /* CHANGED: Reduced opacity for more texture, less "dead white" */
            background: rgba(255, 255, 255, 0.65); 
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            /* CHANGED: Stronger border for better separation against background */
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: 12px;
            /* CHANGED: Deeper shadow for pop */
            box-shadow: 0 20px 50px rgba(0,0,0,0.15);
            opacity: 0; transform: translateY(30px); transition: all 1s ease-out;
        }
        .junzi-cta-section.visible { opacity: 1; transform: translateY(0); }
        
        .junzi-desc {
            font-family: 'Lato', sans-serif;
            color: #1d1d1f;
            /* CHANGED: Increased font size */
            font-size: 1.1rem;
            font-weight: 400;
            margin-top: 25px;
            margin-bottom: 35px;
            letter-spacing: 0.05em;
            line-height: 1.6;
        }
        .junzi-btn {
            display: inline-block;
            /* CHANGED: Larger padding for a bolder button */
            padding: 16px 50px;
            background-color: transparent;
            color: var(--junzi-green);
            border: 2px solid var(--junzi-green);
            text-decoration: none;
            font-family: 'Lato', sans-serif;
            font-weight: 700;
            /* CHANGED: Larger font size */
            font-size: 0.8rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            border-radius: 100px;
            transition: all 0.3s cubic-bezier(0.25, 1, 0.5, 1);
        }
        .junzi-btn:hover { 
            background-color: var(--junzi-green); 
            color: white;
            box-shadow: 0 5px 20px rgba(76, 183, 133, 0.4);
            transform: translateY(-2px);
        }

        #footer { 
            position: fixed; bottom: 0; left: 0; width: 100%; height: 60px; 
            background: rgba(20, 30, 30, 0.5); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); z-index: 1000; 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 0 30px; border-top: 1px solid rgba(255,255,255,0.08); 
        }
        .footer-left { font-family: 'Lato', sans-serif; font-weight: 900; font-size: 1.1rem; letter-spacing: 2px; color: white; }
        .footer-right { display: flex; align-items: center; gap: 12px; }
        .supported-text { font-family: 'Lato', sans-serif; font-size: 0.5rem; font-weight: 700; letter-spacing: 1px; color: rgba(255, 255, 255, 0.5); text-transform: uppercase; margin-top: 4px; }
        .junzi-brand { display: flex; flex-direction: column; align-items: flex-start; line-height: 1; }
        .junzi-en { font-family: 'Lato', sans-serif; font-weight: 700; font-size: 1.3rem; color: var(--junzi-green); letter-spacing: 0.5px; }
        .junzi-cn { font-family: "Noto Sans SC", sans-serif; font-size: 0.6rem; font-weight: 500; color: var(--junzi-green); letter-spacing: 2px; margin-top: 1px; }
        #back-to-top { position: fixed; bottom: 80px; right: 20px; width: 44px; height: 44px; background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.3); border-radius: 50%; display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; cursor: pointer; z-index: 999; opacity: 0; pointer-events: none; transition: all 0.3s ease; gap: 1px; }
        #back-to-top.visible { opacity: 1; pointer-events: auto; }
        #back-to-top:hover { background: rgba(255,255,255,0.3); }
        #photobooth-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000; display: flex; flex-direction: column; align-items: center; justify-content: center; opacity: 0; pointer-events: none; transition: opacity 0.4s ease; padding: 20px; visibility: hidden; background: rgba(10, 10, 10, 0.95); backdrop-filter: blur(30px); -webkit-backdrop-filter: blur(30px); }
        #photobooth-modal.active { opacity: 1; pointer-events: auto; visibility: visible; }
        .close-modal { position: absolute; top: 30px; right: 30px; font-size: 2rem; cursor: pointer; opacity: 0.7; z-index: 2001; transition: opacity 0.3s; color: white; }
        .pb-container { width: 100%; max-width: 400px; display: flex; flex-direction: column; align-items: center; gap: 20px; height: 90vh; justify-content: center; }
        #canvas-wrapper { 
            width: 100%; aspect-ratio: 1 / 4; background: #000; border-radius: 2px; overflow: hidden; position: relative; box-shadow: 0 30px 60px rgba(0,0,0,0.4); display: flex; justify-content: center; align-items: center; flex-grow: 0; height: 70%; 
        }
        #pb-canvas { 
            width: 100%; height: 100%; object-fit: contain; 
            will-change: transform, filter;
            transform: translateZ(0);
        }
        #canvas-placeholder { position: absolute; color: rgba(255,255,255,0.5); font-family: 'Lato'; font-size: 0.9rem; pointer-events: none; text-align: center; line-height: 1.5; padding: 20px; width: 100%; font-weight: 300; letter-spacing: 1px;}
        .filter-buttons { display: flex; gap: 10px; justify-content: center; width: 100%; }
        .filter-btn { padding: 8px 16px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.05); color: rgba(255,255,255,0.8); font-size: 0.7rem; font-family: 'Lato'; text-transform: uppercase; cursor: pointer; transition: 0.3s; }
        .filter-btn.active { background: var(--text-main); color: black; font-weight: bold; border-color: white; }
        .pb-controls { display: flex; flex-direction: column; gap: 12px; width: 100%; justify-content: center; align-items: center;}
        #file-input { display: none; }
        #divination-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100dvh; 
            z-index: 2000; display: flex; flex-direction: column; align-items: center; justify-content: center;
            opacity: 0; pointer-events: none; transition: opacity 0.6s ease;
            visibility: hidden; background-color: #f2f2f2;
        }
        #divination-modal.active { opacity: 1; pointer-events: auto; visibility: visible; }
        #divination-modal .close-modal { color: #333; top: 30px; right: 30px; }
        .shaker-container { display: flex; flex-direction: column; align-items: center; gap: 30px; z-index: 10; margin: 0 auto; }
        .shaker-box {
            width: 120px; height: 220px;
            background: linear-gradient(135deg, #e0e0e0 0%, #ffffff 50%, #dcdcdc 100%);
            border-radius: 4px;
            box-shadow: 0 40px 80px rgba(0,0,0,0.15), inset 0 2px 4px rgba(255,255,255,0.8);
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; position: relative; border: 1px solid #ccc;
        }
        .shaker-box::after { content: "TAP TO SHAKE"; position: absolute; bottom: -50px; font-family: 'Lato'; font-size: 0.65rem; letter-spacing: 0.3em; color: #999; }
        .shaking { animation: shakeAnim 0.5s cubic-bezier(.36,.07,.19,.97) both infinite; }
        @keyframes shakeAnim { 0% { transform: translate(1px, 1px) rotate(0deg); } 20% { transform: translate(-3px, 0px) rotate(1deg); } 40% { transform: translate(1px, -1px) rotate(1deg); } 60% { transform: translate(-3px, 1px) rotate(0deg); } 80% { transform: translate(-1px, -1px) rotate(1deg); } 100% { transform: translate(1px, -2px) rotate(-1deg); } }
        .fortune-strip {
            position: relative;
            width: 320px; max-width: 85vw; min-height: 600px; 
            background-color: #fffcf8;
            background-image: url("data:image/svg+xml,%3Csvg width='200' height='200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='200' height='200' fill='transparent'/%3E%3Crect width='200' height='200' filter='url(%23n)' opacity='0.05'/%3E%3C/svg%3E");
            box-shadow: 0 30px 70px rgba(0,0,0,0.1), 0 5px 15px rgba(0,0,0,0.05);
            padding: 70px 35px;
            display: none; flex-direction: column; align-items: center; text-align: center;
            transform: translateY(30px); opacity: 0;
            transition: transform 0.8s cubic-bezier(0.2, 0.8, 0.2, 1), opacity 0.8s;
            border-radius: 2px;
            user-select: none; -webkit-user-select: none;
        }
        .fortune-strip.ready { display: flex; opacity: 1; transform: translateY(0); }
        .strip-header { width: 100%; border-bottom: 1px solid rgba(0,0,0,0.08); padding-bottom: 25px; margin-bottom: 50px; display: flex; justify-content: center; }
        .strip-logo { font-family: 'Playfair Display'; font-weight: 700; font-style: italic; font-size: 1.3rem; letter-spacing: 0.05em; color: #d4af37; }
        .strip-content { flex-grow: 1; display: flex; flex-direction: column; align-items: center; width: 100%; filter: blur(15px); opacity: 0.1; transition: filter 2.5s ease-out, opacity 2.5s ease-out; color: var(--fate-text); }
        .fortune-strip.revealed .strip-content { filter: blur(0); opacity: 1; }
        .f-title { font-family: 'Playfair Display', serif; font-size: 1.8rem; font-weight: 700; letter-spacing: 0.1em; color: #111; margin-bottom: 8px; text-transform: uppercase; }
        .f-subtitle { font-family: "Songti SC", "SimSun", "STSong", "Noto Serif SC", serif; font-size: 0.9rem; color: #999; margin-bottom: 50px; letter-spacing: 0.8em; font-weight: 300; margin-left: 0.8em; }
        .f-text-en { font-family: 'Playfair Display', serif; font-size: 1.3rem; line-height: 1.4; font-style: italic; color: #333; margin-bottom: 30px; max-width: 95%; }
        .f-text-cn { font-family: "Songti SC", "SimSun", "STSong", "Noto Serif SC", serif; font-size: 1rem; line-height: 2.2; font-weight: 300; color: #555; letter-spacing: 0.2em; margin-top: 25px; border-top: 1px solid rgba(0,0,0,0.08); padding-top: 35px; width: 75%; }
        .reveal-hint { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; z-index: 10; pointer-events: none; transition: opacity 0.5s; }
        .reveal-hint span { background: rgba(255,255,255,0.95); padding: 14px 28px; font-family: 'Lato'; letter-spacing: 3px; font-size: 0.65rem; color: #999; border: 1px solid rgba(0,0,0,0.05); border-radius: 100px; text-transform: uppercase; box-shadow: 0 10px 25px rgba(0,0,0,0.05); animation: pulse 2.5s infinite; }
        .fortune-strip.revealing .reveal-hint { opacity: 0; }
        .fortune-strip.revealed .reveal-hint { display: none; }
        @keyframes pulse { 0% { opacity: 0.6; transform: scale(0.98); } 50% { opacity: 1; transform: scale(1.02); } 100% { opacity: 0.6; transform: scale(0.98); } }
        .f-footer { margin-top: auto; font-family: 'Lato'; font-size: 0.5rem; letter-spacing: 2px; color: #ccc; margin-top: 40px; text-transform: uppercase; }
        #redraw-btn { margin-top: 40px; opacity: 0; pointer-events: none; transition: opacity 0.5s; color: #555; border-color: #ccc; background: transparent; font-size: 0.7rem;}
        #redraw-btn.visible { opacity: 1; pointer-events: auto; }
        #redraw-btn:hover { background: rgba(0,0,0,0.03); color: #000; border-color: #999; }
    </style>
</head>
<body>
    <div id="hero-layer">
        <div class="poster-container">
            <img src="logo.jpg" class="main-logo fade-up" alt="QingBai Logo">
            <div class="typography-cluster fade-up">
                <div class="big-title">QING BAI</div>
                <div class="script-title">Innocence</div>
                <div class="subtitle-text">INSPIRED BY <span>THE LEGEND OF THE WHITE SNAKE</span></div>
            </div>
            <div class="info-cluster fade-up">
                <div class="quote-group">
                    <div class="quote-en">When myth sheds its skin, it becomes movement.</div>
                    <div class="quote-cn">当神话脱去皮肤，它成为了身体的运动。</div>
                </div>
                <div class="button-group">
                    <a href="https://www.instagram.com/qingbai_innocence/?hl=en" target="_blank" class="glass-btn">EXPLORE INS</a>
                    <button id="open-pb-btn" class="glass-btn special">PHOTO BOOTH</button>
                    <button id="open-fate-btn" class="glass-btn">DRAW FATE</button>
                    <button id="program-btn" class="glass-btn">PROGRAM</button>
                </div>
            </div>
        </div>
    </div>
    <div id="digital-program">
        <img src="poster.jpg" class="content-img" alt="Main Poster">
        <img src="poster_new.jpg" class="content-img" alt="Feature">
        <img src="intro.jpg" class="content-img">
        <img src="pgcast1.jpg" class="content-img" alt="Cast 1">
        <img src="pgcast2.jpg" class="content-img" alt="Cast 2">
        <img src="credit creative.jpg" class="content-img" alt="Creative Team">
        <img src="credit produciton-.jpg" class="content-img" alt="Production Team">
        <div class="here-section">
            <div class="here-pre-title">PROUDLY PRESENTED AT</div>
            <h2 class="here-header">HERE Arts Center</h2>
            <div class="here-content">
                <p>Since 1993, HERE has been one of New York’s most prolific producing organizations, and today, it stands at the forefront of the city’s downtown theatre scene. HERE produces and presents groundbreaking hybrid performances in theatre, dance, music, puppetry, media, and visual art.</p>
                <p>Our artist residency programs, including the HERE Artist Residency Program (HARP), provide a home for artists to develop their visions and disrupt conventional expectations. From our home in Lower Manhattan, we build an inclusive community that nurtures artists of all backgrounds.</p>
                <p>We welcome curious audiences to witness the unfolding of new mythologies and experience art that is responsive to the world in which we live.</p>
            </div>
            <div class="here-links">
                <a href="https://here.org" target="_blank" class="here-link-item"><i class="fas fa-globe"></i><span>WEBSITE</span></a>
                <a href="https://www.instagram.com/herearts/" target="_blank" class="here-link-item"><i class="fab fa-instagram"></i><span>INSTAGRAM</span></a>
                <a href="https://twitter.com/herearts" target="_blank" class="here-link-item"><i class="fab fa-x-twitter"></i><span>TWITTER/X</span></a>
            </div>
        </div>
        <img src="program sponsor 9.jpg" class="content-img" alt="Sponsors">
        <div class="junzi-cta-section content-img">
            <div class="junzi-brand" style="align-items: center;">
                <span class="junzi-en" style="color: #4CB785; font-size: 2rem;">junzi</span>
                <span class="junzi-cn" style="color: #4CB785; letter-spacing: 3px; font-size: 0.8rem; margin-top: 5px;">君子食堂</span>
            </div>
            <p class="junzi-desc">Explore authentic Northern Chinese flavors tailored for you.</p>
            <a href="https://www.junzi.kitchen/" target="_blank" class="junzi-btn">Explore Menu & Order</a>
        </div>
    </div>
    <footer id="footer">
        <div class="footer-left">HERE</div>
        <div class="footer-right">
            <span class="supported-text">supported by</span>
            <div class="junzi-brand"><span class="junzi-en">junzi</span><span class="junzi-cn">君子食堂</span></div>
        </div>
    </footer>
    <div id="back-to-top" onclick="window.scrollTo(0,0)">
        <i class="fas fa-chevron-up" style="font-size: 0.8rem; margin-top: -2px;"></i>
        <i class="fas fa-home" style="font-size: 0.6rem;"></i>
    </div>
    <img id="frame-bg" src="back.jpg" style="display:none;" crossorigin="anonymous">
    <img id="frame-logo" src="logo.jpg" style="display:none;" crossorigin="anonymous">
    <div id="photobooth-modal">
        <div id="close-pb" class="close-modal">&times;</div>
        <div class="pb-container">
            <div class="filter-buttons">
                <div class="filter-btn active" data-filter="none">Classic</div>
                <div class="filter-btn" data-filter="noir">Noir</div>
                <div class="filter-btn" data-filter="warm">Vintage</div>
                <div class="filter-btn" data-filter="cool">Jade</div>
            </div>
            <div id="canvas-wrapper">
                <div id="canvas-placeholder">Tap "Take Photo" to start<br>your 4-shot sequence.</div>
                <canvas id="pb-canvas"></canvas>
            </div>
            <div class="pb-controls">
                <button id="camera-btn" class="glass-btn special" style="width: 80%;">Take Photo (1/4)</button>
                <a id="save-btn" class="glass-btn" style="display: none; width: 80%;" download="qingbai-strip.png">Download Strip</a>
                <button id="reset-pb-btn" class="glass-btn" style="display: none; width: 80%; border-color: rgba(255,255,255,0.3); color: rgba(255,255,255,0.7);">RETAKE</button>
            </div>
            <input type="file" id="file-input" accept="image/*" capture="user">
        </div>
    </div>
    <div id="divination-modal">
        <div id="close-fate" class="close-modal">&times;</div>
        <div id="shaker-container" class="shaker-container">
            <div id="shaker-box" class="shaker-box">
                <i class="fas fa-ellipsis-v" style="color:#aaa; font-size: 1.5rem;"></i>
            </div>
        </div>
        <div id="fortune-strip" class="fortune-strip">
            <div class="reveal-hint">
                <span id="hint-text">Hold to Reveal</span>
            </div>
            <div class="strip-header">
                <div class="strip-logo">QingBai</div>
            </div>
            <div class="strip-content">
                <div class="f-title" id="f-title">INNOCENCE</div>
                <div class="f-subtitle" id="f-subtitle">清白</div>
                <div class="f-text-en" id="f-en">“Tonight, your name grows a second meaning.”</div>
                <div class="f-text-cn" id="f-cn">今夜，你的名字悄悄换了另一层意思。<br>哪一层继续呼吸，由你决定。</div>
            </div>
            <div class="f-footer">
                OLFACTORY MEMORY TEST No.<span id="f-num">01</span>
            </div>
        </div>
        <button id="redraw-btn" class="glass-btn">Draw Again</button>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const backToTopBtn = document.getElementById('back-to-top');
            window.addEventListener('scroll', () => { backToTopBtn.classList.toggle('visible', window.scrollY > window.innerHeight * 0.5); });
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('visible'); });
            }, { threshold: 0.1 });
            document.querySelectorAll('.content-img, .here-section, .junzi-cta-section').forEach(el => observer.observe(el));
            const programBtn = document.getElementById('program-btn');
            const programSection = document.getElementById('digital-program');
            if (programBtn) {
                programBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    programSection.classList.add('active');
                    setTimeout(() => {
                        programSection.scrollIntoView({ behavior: 'smooth' });
                    }, 50);
                });
            }
            const pbModal = document.getElementById('photobooth-modal');
            const openPbBtn = document.getElementById('open-pb-btn');
            const closePbBtn = document.getElementById('close-pb');
            const cameraBtn = document.getElementById('camera-btn');
            const fileInput = document.getElementById('file-input');
            const canvas = document.getElementById('pb-canvas');
            const ctx = canvas ? canvas.getContext('2d') : null;
            const saveBtn = document.getElementById('save-btn');
            const resetPbBtn = document.getElementById('reset-pb-btn');
            const pbPlaceholder = document.getElementById('canvas-placeholder');
            const filterBtns = document.querySelectorAll('.filter-btn');
            const frameBg = document.getElementById('frame-bg');
            const frameLogo = document.getElementById('frame-logo');
            let capturedPhotos = [];
            let currentFilter = 'none';
            if(openPbBtn) openPbBtn.addEventListener('click', () => { resetPhotoBooth(); pbModal.classList.add('active'); });
            if(closePbBtn) closePbBtn.addEventListener('click', () => pbModal.classList.remove('active'));
            filterBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    filterBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentFilter = btn.getAttribute('data-filter');
                    if (capturedPhotos.length > 0) composeStrip();
                });
            });
            if(cameraBtn) {
                cameraBtn.addEventListener('click', () => fileInput.click());
                fileInput.addEventListener('change', (e) => {
                    if (e.target.files && e.target.files[0]) {
                        const reader = new FileReader();
                        reader.onload = (ev) => {
                            const img = new Image();
                            img.onload = () => { capturedPhotos.push(img); updateBooth(); };
                            img.src = ev.target.result;
                        };
                        reader.readAsDataURL(e.target.files[0]);
                        fileInput.value = '';
                    }
                });
            }
            if(resetPbBtn) {
                resetPbBtn.addEventListener('click', () => {
                    resetPhotoBooth();
                });
            }
            function resetPhotoBooth() {
                capturedPhotos = []; 
                cameraBtn.style.display='inline-flex'; cameraBtn.disabled=false; cameraBtn.textContent='Take Photo (1/4)';
                saveBtn.style.display='none'; 
                resetPbBtn.style.display='none';
                pbPlaceholder.style.display='block'; 
                if(ctx) ctx.clearRect(0,0,canvas.width,canvas.height);
            }
            function updateBooth() {
                composeStrip();
                if(capturedPhotos.length > 0) {
                    resetPbBtn.style.display = 'inline-flex';
                }
                if(capturedPhotos.length < 4) {
                    cameraBtn.textContent = `Take Photo (${capturedPhotos.length+1}/4)`; 
                    pbPlaceholder.style.display='none';
                } else { 
                    cameraBtn.style.display='none'; 
                }
            }
            function composeStrip() {
                const stripWidth = 800; 
                const photoSize = 600; 
                const padding = 50; 
                const topMargin = 50;
                const totalHeight = (photoSize * 4) + (padding * 5) + 300; 
                canvas.width = stripWidth; 
                canvas.height = totalHeight;
                if (frameBg && frameBg.complete && frameBg.naturalHeight !== 0) {
                    drawCover(ctx, frameBg, stripWidth, totalHeight, 0, 0);
                } else {
                    ctx.fillStyle = "#a4dcd3"; ctx.fillRect(0,0,stripWidth,totalHeight); 
                }
                let currentY = topMargin + padding;
                capturedPhotos.forEach(photo => {
                    ctx.fillStyle = "rgba(255, 255, 255, 0.95)";
                    ctx.shadowColor = "rgba(0,0,0,0.15)"; ctx.shadowBlur = 20;
                    ctx.fillRect(padding, currentY, photoSize + (padding * 2), photoSize + (padding * 2));
                    ctx.shadowBlur = 0;
                    const drawX = padding + 20;
                    const drawY = currentY + 20;
                    const drawSize = photoSize + (padding * 2) - 40;
                    ctx.save();
                    ctx.beginPath();
                    ctx.rect(drawX, drawY, drawSize, drawSize);
                    ctx.clip();
                    ctx.filter = getFilter(currentFilter);
                    drawCover(ctx, photo, drawSize, drawSize, drawX, drawY);
                    ctx.restore();
                    currentY += photoSize + (padding * 2) + 40;
                });
                if (frameLogo && frameLogo.complete && frameLogo.naturalHeight !== 0) {
                    const logoW = 200;
                    const logoH = (frameLogo.naturalHeight / frameLogo.naturalWidth) * logoW;
                    ctx.drawImage(frameLogo, stripWidth - logoW - 30, 30, logoW, logoH);
                }
                if(capturedPhotos.length===4) { saveBtn.href = canvas.toDataURL(); saveBtn.style.display='inline-flex'; }
            }
            function drawCover(ctx, img, w, h, x, y) {
                const imgRatio = img.width / img.height;
                const canvasRatio = w / h;
                let drawW, drawH, drawX, drawY;
                if (imgRatio > canvasRatio) {
                    drawH = h; drawW = h * imgRatio;
                    drawX = x + (w - drawW) / 2; drawY = y;
                } else {
                    drawW = w; drawH = w / imgRatio;
                    drawX = x; drawY = y + (h - drawH) / 2;
                }
                ctx.drawImage(img, drawX, drawY, drawW, drawH);
            }
            function getFilter(t) { return t==='noir'?'grayscale(100%) contrast(110%)' : t==='warm'?'sepia(40%) contrast(105%) brightness(105%)' : t==='cool'?'hue-rotate(-15deg) contrast(105%) saturate(110%)' : 'none'; }
            const fateModal = document.getElementById('divination-modal');
            const openFateBtn = document.getElementById('open-fate-btn');
            const closeFateBtn = document.getElementById('close-fate');
            const shakerContainer = document.getElementById('shaker-container');
            const shakerBox = document.getElementById('shaker-box');
            const fortuneStrip = document.getElementById('fortune-strip');
            const redrawBtn = document.getElementById('redraw-btn');
            const hintText = document.getElementById('hint-text');
            const fortunes = [
                { k: "INNOCENCE", sub: "清白", en: "Tonight, your name gathers a second meaning.\nOnly you can decide which one lives.", cn: "今夜，你的名字悄悄换了另一层意思。\n哪一层继续呼吸，由你决定。" },
                { k: "SKIN", sub: "皮", en: "Something beneath your skin is beginning to move.\nDon’t quiet it.", cn: "你的皮下正有东西慢慢苏醒。\n别压住它。" },
                { k: "DESIRE", sub: "欲", en: "Desire never asks permission.\nIt recognizes you before you recognize it.", cn: "欲念从不敲门。\n它总是先找到你。" },
                { k: "FATE", sub: "劫", en: "You are already standing where the story meant to place you.\nListen to the floor beneath you.", cn: "你已经站在命运要你来的地方。\n倾听脚下的动静。" },
                { k: "TRIAL", sub: "审", en: "What you hide burns brightest in the dark.\nLet it speak—just once.", cn: "你藏得最深的，反而在黑暗里最亮。\n让它说一句。" },
                { k: "BODY", sub: "身", en: "Your body tells the truth faster than your mouth.\nFollow what speaks first.", cn: "身体说真话，比嘴更快。\n跟随最先开口的那个声音。" },
                { k: "LONGING", sub: "念", en: "Someone keeps returning to you in the quiet.\nYou already know who.", cn: "有一个名字一直在静处找你。\n你知道是谁。" },
                { k: "TRANSFORMATION", sub: "化", en: "A version of you has finished its work.\nThank it, and step out of it.", cn: "旧的你已经完成任务。\n向它道别，然后离开。" },
                { k: "MYTH", sub: "传", en: "Tonight, a story chooses your body to move through.\nLet it pass.", cn: "今夜，有个故事选择借你的身体行走。\n让它穿过去。" },
                { k: "SECRET", sub: "秘", en: "The secret you carry weighs more than you admit.\nSet it down for one breath.", cn: "你背着的，比你承认的更重。\n先放下一息。" },
                { k: "BRIDGE", sub: "桥", en: "You are closer to the crossing than you think.\nThe other side has already seen you.", cn: "你比想象中更接近那座桥。\n对岸的人早已看见你。" },
                { k: "REBIRTH", sub: "重生", en: "You don’t have to remain the version that survived.\nAnother one is already waiting.", cn: "你不必继续做那个苟且活下来的自己。\n新的你已经在等。" }
            ];
            let holdTimer = null;
            let isRevealed = false;
            if(openFateBtn) openFateBtn.addEventListener('click', () => { resetFate(); fateModal.classList.add('active'); });
            if(closeFateBtn) closeFateBtn.addEventListener('click', () => fateModal.classList.remove('active'));
            function resetFate() {
                shakerContainer.style.display = 'flex';
                shakerBox.classList.remove('shaking');
                fortuneStrip.classList.remove('ready', 'revealing', 'revealed');
                fortuneStrip.style.display = 'none';
                redrawBtn.classList.remove('visible');
                isRevealed = false; 
                clearTimeout(holdTimer);
            }
            shakerBox.addEventListener('click', function() {
                if(navigator.vibrate) navigator.vibrate([100, 30, 100, 30, 100, 30, 100]);
                shakerBox.classList.add('shaking');
                setTimeout(() => {
                    const pick = fortunes[Math.floor(Math.random() * fortunes.length)];
                    const numStr = (fortunes.indexOf(pick) + 1).toString().padStart(2, '0');
                    document.getElementById('f-title').textContent = pick.k;
                    document.getElementById('f-subtitle').textContent = pick.sub;
                    document.getElementById('f-en').innerText = pick.en;
                    document.getElementById('f-cn').innerText = pick.cn;
                    document.getElementById('f-num').textContent = numStr;
                    shakerContainer.style.display = 'none';
                    shakerBox.classList.remove('shaking');
                    fortuneStrip.style.display = 'flex';
                    requestAnimationFrame(() => {
                        fortuneStrip.classList.add('ready');
                        const isTouch = ('ontouchstart' in window);
                        hintText.textContent = isTouch ? "Long Press to Reveal" : "Hold Click to Reveal";
                    });
                }, 1200);
            });
            const startReveal = (e) => {
                if(isRevealed) return;
                if(navigator.vibrate) navigator.vibrate(20); 
                fortuneStrip.classList.add('revealing');
                holdTimer = setTimeout(() => {
                    fortuneStrip.classList.add('revealed');
                    if(navigator.vibrate) navigator.vibrate([30, 50, 30]);
                    isRevealed = true;
                    redrawBtn.classList.add('visible');
                }, 1500); 
            };
            const endReveal = (e) => {
                if(isRevealed) return;
                clearTimeout(holdTimer);
                fortuneStrip.classList.remove('revealing');
            };
            fortuneStrip.addEventListener('touchstart', startReveal, {passive: true});
            fortuneStrip.addEventListener('touchend', endReveal);
            fortuneStrip.addEventListener('touchcancel', endReveal);
            fortuneStrip.addEventListener('mousedown', startReveal);
            fortuneStrip.addEventListener('mouseup', endReveal);
            fortuneStrip.addEventListener('mouseleave', endReveal);
            redrawBtn.addEventListener('click', resetFate);
        });
    </script>
</body>
</html>
